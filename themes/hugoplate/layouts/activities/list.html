{{ define "main" }}
  {{ partial "page-header" . }}

  <section class="py-6">
    <div class="container mx-auto px-4 space-y-12">

      {{ range $index, $page := .RegularPages }}
        {{ with $page.Params.activity }}
          <!-- Activity card: white rounded box with enhanced animations -->
          <div class="group bg-white rounded-2xl shadow-xl overflow-hidden p-6 md:p-8 flex flex-col md:flex-row items-stretch md:gap-8
                      hover:shadow-2xl hover:-translate-y-2 hover:scale-[1.02] 
                      transform transition-all duration-700 ease-out
                      animate-fade-in-up
                      {{ if modBool $index 2 }} md:flex-row-reverse {{ end }}"
               style="animation-delay: {{ mul $index 200 }}ms;">

            <!-- Animated background gradient overlay -->
            <div class="absolute inset-0 bg-gradient-to-r from-blue-500/5 via-purple-500/5 to-pink-500/5 
                        opacity-0 group-hover:opacity-100 transition-opacity duration-500 rounded-2xl"></div>

            <!-- Text section with staggered animations -->
            <div class="relative z-10 w-full md:w-1/2 space-y-4 md:space-y-6 text-center md:text-left flex flex-col justify-center">
              
              <!-- Animated title -->
              <h2 class="text-2xl sm:text-3xl font-bold transform transition-all duration-500 
                         group-hover:text-blue-600 group-hover:scale-105 animate-slide-in-left"
                  style="animation-delay: {{ add (mul $index 200) 100 }}ms;">
                {{ .name | markdownify }}
              </h2>
              
              <!-- Animated description -->
              <p class="text-gray-700 text-base sm:text-lg transform transition-all duration-500 
                       group-hover:text-gray-800 animate-slide-in-left"
                 style="animation-delay: {{ add (mul $index 200) 200 }}ms;">
                {{ .description | truncate 250 | safeHTML | markdownify }}
              </p>
              
              <!-- Enhanced animated button -->
              <div class="animate-slide-in-left" style="animation-delay: {{ add (mul $index 200) 300 }}ms;">
                <a href="{{ $page.RelPermalink }}"
                   class="group/btn inline-flex items-center gap-2 mt-3 sm:mt-4 px-5 py-2 sm:px-6 sm:py-3 
                          bg-primary text-white rounded-lg shadow 
                          hover:bg-light hover:shadow-lg hover:scale-105 hover:-translate-y-1
                          transform transition-all duration-300 ease-out
                          text-sm sm:text-base relative overflow-hidden">
                  
                  <!-- Button ripple effect -->
                  <div class="absolute inset-0 bg-white/20 scale-x-0 group-hover/btn:scale-x-100 
                              transition-transform duration-300 origin-left"></div>
                  
                  <span class="relative z-10">See activity</span>
                  <svg class="relative z-10 w-4 h-4 transform group-hover/btn:translate-x-1 transition-transform duration-300" 
                       fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                  </svg>
                </a>
              </div>
            </div>

            <!-- Image section with enhanced animations and logo overlay -->
            {{ $imageStr := .image }}
            {{ $image := printf "%s" (substr $imageStr 1) }}
            {{ $logoStr := .logo }}
            {{ $logo := printf "%s" (substr $logoStr 1) }}

            <div class="w-full md:w-1/2 relative group/image rounded-xl overflow-hidden shadow-lg cursor-pointer 
                        min-h-[250px] mt-6 md:mt-0 transform transition-all duration-700 ease-out
                        hover:shadow-xl hover:scale-105 hover:-rotate-1 animate-zoom-in"
                 style="animation-delay: {{ add (mul $index 200) 150 }}ms;"
                 onclick="window.location.href='{{ $page.RelPermalink }}'">

              <!-- Animated overlay -->
              <div class="absolute inset-0 bg-gradient-to-br from-blue-600/20 via-transparent to-purple-600/20 
                          opacity-0 group-hover/image:opacity-60 transition-opacity duration-500 z-20"></div>

              <!-- Background image with enhanced hover effects -->
              <div class="absolute inset-0 transition-all duration-700 ease-out
                          group-hover/image:scale-110 group-hover/image:brightness-110 group-hover/image:contrast-105"
                   style="background-image: url('{{ $image | absURL }}'); background-size: cover; background-position: center;"></div>

              <!-- Animated floating elements -->
              <div class="absolute top-4 right-4 w-2 h-2 bg-white/40 rounded-full 
                          animate-bounce opacity-0 group-hover/image:opacity-100 transition-opacity duration-500"
                   style="animation-delay: 0.5s;"></div>
              <div class="absolute bottom-6 left-6 w-1 h-1 bg-blue-300/50 rounded-full 
                          animate-pulse opacity-0 group-hover/image:opacity-100 transition-opacity duration-500"
                   style="animation-delay: 1s;"></div>

              <!-- Enhanced logo with multiple animation layers -->
              <div class="absolute inset-0 flex items-center justify-center z-30">
                <div class="bg-white/90 backdrop-blur-sm rounded-full p-4 shadow-md flex items-center justify-center
                            w-20 h-20 sm:w-24 sm:h-24 md:w-28 md:h-28
                            transform transition-all duration-500 ease-out
                            group-hover/image:scale-110 group-hover/image:shadow-xl group-hover/image:rotate-6
                            group-hover/image:bg-white/95 animate-float">
                  
                  <!-- Logo pulse effect on hover -->
                  <div class="absolute inset-0 bg-blue-500/10 rounded-full scale-0 
                              group-hover/image:scale-110 group-hover/image:animate-ping 
                              transition-transform duration-300"></div>
                  
                  <!-- Logo container -->
                  <div class="relative transform group-hover/image:scale-105 transition-transform duration-300">
                    {{ partial "image" (dict "Src" $logo "Alt" "Activity logo" "Class" "w-full h-full object-contain") }}
                  </div>
                </div>
              </div>

            </div>

          </div>
        {{ end }}
      {{ end }}

    </div>
  </section>

  <!-- Custom CSS for advanced animations -->
  <style>
    @keyframes fade-in-up {
      0% {
        opacity: 0;
        transform: translateY(30px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slide-in-left {
      0% {
        opacity: 0;
        transform: translateX(-20px);
      }
      100% {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes zoom-in {
      0% {
        opacity: 0;
        transform: scale(0.9);
      }
      100% {
        opacity: 1;
        transform: scale(1);
      }
    }

    @keyframes float {
      0%, 100% {
        transform: translateY(0px);
      }
      50% {
        transform: translateY(-5px);
      }
    }

    .animate-fade-in-up {
      animation: fade-in-up 0.8s ease-out forwards;
      opacity: 0;
    }

    .animate-slide-in-left {
      animation: slide-in-left 0.6s ease-out forwards;
      opacity: 0;
    }

    .animate-zoom-in {
      animation: zoom-in 0.7s ease-out forwards;
      opacity: 0;
    }

    .animate-float {
      animation: float 3s ease-in-out infinite;
    }

    /* Smooth scrolling enhancement */
    html {
      scroll-behavior: smooth;
    }

    /* Enhanced focus states for accessibility */
    .group:focus-within {
      outline: 2px solid #3b82f6;
      outline-offset: 2px;
    }
  </style>
{{ end }}